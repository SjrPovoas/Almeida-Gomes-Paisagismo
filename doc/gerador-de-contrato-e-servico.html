<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Documentos Almeida Gomes</title>
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configuração de Fonte padrão (Inter é um bom sans-serif profissional) */
        :root {
            font-family: 'Inter', sans-serif;
        }

        /* Cores inspiradas no site da Almeida Gomes Paisagismo (Verde profundo e branco) */
        .agp-green {
            background-color: #0b4e3e; /* Um verde floresta profundo */
        }
        .agp-text-green {
            color: #0b4e3e;
        }
        .agp-border-green {
            border-color: #0b4e3e;
        }

        /* Estilos específicos para a visualização de impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                /* Remove margens e padding para aproveitar todo o papel */
                padding: 0;
                margin: 0;
                box-shadow: none; /* Remove a sombra do card */
                font-size: 11pt; /* Tamanho de fonte padrão para documentos */
            }
            .no-print {
                display: none !important;
            }
            /* Garantir que o texto verde seja preto na impressão para melhor contraste */
            .agp-text-green {
                color: black !important;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">

    <!-- Cabeçalho (Inspirado no branding) -->
    <header class="w-full max-w-4xl p-4 mb-6 text-center bg-white rounded-lg shadow-md">
        <h1 class="text-3xl font-bold agp-text-green">Almeida Gomes Paisagismo</h1>
        <p class="text-gray-600 mt-1">Gerador Online de Contratos e Recibos</p>
    </header>

    <main class="w-full max-w-4xl bg-white rounded-lg shadow-xl p-6 md:p-8">

        <!-- Área de Controles e Formulário (Oculta na impressão) -->
        <section id="form-section" class="no-print">
            <div class="mb-6 flex justify-between items-center border-b pb-4">
                <h2 class="text-2xl font-semibold text-gray-800">Detalhes do Documento</h2>
                
                <!-- Toggle Contrato / Recibo -->
                <div class="flex p-1 rounded-full bg-gray-200">
                    <button id="toggleContract" onclick="setDocType('contract')" class="px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200">
                        Contrato
                    </button>
                    <button id="toggleReceipt" onclick="setDocType('receipt')" class="px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200">
                        Recibo
                    </button>
                </div>
            </div>

            <!-- Formulário -->
            <form id="docForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Informações do Cliente -->
                <div class="md:col-span-2">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Dados do Cliente</h3>
                </div>
                <input type="text" id="nomeCliente" placeholder="Nome do Cliente/Empresa" class="form-input" required>
                <input type="text" id="cpfCliente" placeholder="CPF/CNPJ do Cliente" class="form-input">
                <input type="text" id="enderecoCliente" placeholder="Endereço Completo do Cliente" class="form-input md:col-span-2" required>

                <!-- Informações do Serviço -->
                <div class="md:col-span-2 mt-4">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Dados do Serviço</h3>
                </div>
                <input type="text" id="tituloServico" placeholder="Título Curto do Serviço (Ex: Projeto de Paisagismo)" class="form-input md:col-span-2" required>
                <textarea id="descricaoServico" rows="4" placeholder="Descrição Detalhada do Serviço. (Cláusula 1 - Objeto)" class="form-input md:col-span-2" required></textarea>
                
                <!-- Datas e Valores -->
                <input type="number" id="valorTotal" step="0.01" placeholder="Valor Total (R$)" class="form-input" required>
                <select id="metodoPagamento" class="form-input" disabled>
                    <option value="" disabled selected>Método de Pagamento</option>
                    <option value="Pix">Pix</option>
                    <option value="Transferência Bancária">Transferência Bancária</option>
                    <option value="Dinheiro">Dinheiro</option>
                    <option value="Cartão de Crédito/Débito">Cartão de Crédito/Débito</option>
                </select>

                <input type="date" id="dataInicio" class="form-input" required>
                <input type="date" id="dataFim" class="form-input" required>

                <!-- Campo Adicional para Contrato -->
                <div class="md:col-span-2 mt-4" id="contractFields">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Cláusulas Adicionais (Contrato)</h3>
                    <textarea id="clausulasAdicionais" rows="3" placeholder="Insira quaisquer cláusulas adicionais importantes aqui (Ex: Multas, Garantia, Rescisão)." class="form-input md:col-span-2"></textarea>
                </div>
            </form>

            <!-- Botão de Geração -->
            <button id="generateButton" onclick="renderPreview()" class="w-full mt-8 py-3 rounded-lg text-white font-bold transition duration-300 agp-green hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                Gerar Contrato para Visualização
            </button>
        </section>

        <!-- Área de Visualização e Impressão (Aparece após gerar) -->
        <section id="preview-section" class="hidden mt-8 border-t pt-6">
            <div class="flex justify-between items-center mb-4 no-print">
                <h2 class="text-xl font-semibold text-gray-800">Visualização do Documento</h2>
                <div class="space-x-2">
                    <button onclick="printDocument()" class="px-4 py-2 text-sm font-medium rounded-lg text-white transition duration-200 agp-green hover:bg-green-700">
                        Imprimir / Salvar PDF
                    </button>
                    <button onclick="hidePreview()" class="px-4 py-2 text-sm font-medium rounded-lg bg-gray-300 hover:bg-gray-400">
                        Editar
                    </button>
                </div>
            </div>

            <!-- Container do Documento Gerado -->
            <div id="document-output" class="print-area bg-white p-6 border agp-border-green rounded-lg shadow-inner">
                <!-- O conteúdo HTML do contrato ou recibo será inserido aqui pelo JavaScript -->
            </div>
        </section>

    </main>

    <footer class="mt-6 text-sm text-gray-500">
        Desenvolvido com foco em profissionalismo e facilidade.
    </footer>

    <script>
        // Variáveis Globais de Estado
        let currentDocType = 'contract'; // 'contract' ou 'receipt'

        // Dados fixos da empresa (Almeida Gomes Paisagismo)
        const companyInfo = {
            name: "ALMEIDA GOMES PAISAGISMO LTDA",
            cnpj: "XX.XXX.XXX/0001-XX (CNPJ fictício)",
            address: "Rua Exemplo, 123 - Bairro Centro, Cidade/UF (Endereço Fictício)",
            email: "contato@almeidagomespaisagismo.com.br",
            representative: "Representante Legal"
        };

        // Estilização dos botões de toggle
        const toggleButtons = {
            contract: document.getElementById('toggleContract'),
            receipt: document.getElementById('toggleReceipt')
        };
        const paymentSelect = document.getElementById('metodoPagamento');
        const contractFieldsDiv = document.getElementById('contractFields');

        // Estilo padrão para o botão ativo
        const activeClass = 'agp-green text-white';
        const inactiveClass = 'bg-gray-200 text-gray-700 hover:bg-gray-300';

        /**
         * Inicializa o estado visual do toggle ao carregar
         */
        function initializeToggle() {
            setDocType('contract', false); // Chama para configurar o estado inicial
        }
        
        /**
         * Altera o tipo de documento a ser gerado ('contract' ou 'receipt').
         * @param {string} type - 'contract' ou 'receipt'.
         * @param {boolean} updateButtonText - Se deve atualizar o texto do botão de geração.
         */
        function setDocType(type, updateButtonText = true) {
            currentDocType = type;

            // 1. Atualiza a aparência dos botões de toggle
            toggleButtons.contract.className = `px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200 ${type === 'contract' ? activeClass : inactiveClass}`;
            toggleButtons.receipt.className = `px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200 ${type === 'receipt' ? activeClass : inactiveClass}`;

            // 2. Habilita/Desabilita campos específicos
            if (type === 'receipt') {
                paymentSelect.disabled = false;
                paymentSelect.setAttribute('required', 'required');
                contractFieldsDiv.classList.add('hidden');
            } else { // contract
                paymentSelect.disabled = true;
                paymentSelect.removeAttribute('required');
                contractFieldsDiv.classList.remove('hidden');
                // Limpa o valor do recibo se houver, para evitar confusão no contrato
                paymentSelect.value = ""; 
            }

            // 3. Atualiza o texto do botão de geração
            if (updateButtonText) {
                const button = document.getElementById('generateButton');
                button.textContent = `Gerar ${type === 'contract' ? 'Contrato' : 'Recibo'} para Visualização`;
            }
        }

        /**
         * Coleta os dados do formulário em um objeto.
         */
        function getFormData() {
            const data = {};
            const formElements = document.getElementById('docForm').elements;
            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];
                if (element.id) {
                    data[element.id] = element.value;
                }
            }
            return data;
        }

        /**
         * Formata um valor numérico para o formato monetário Brasileiro (R$ X.XXX,XX).
         * @param {string} value - O valor em string do input.
         * @returns {string} O valor formatado.
         */
        function formatCurrency(value) {
            const num = parseFloat(value);
            if (isNaN(num)) return 'R$ 0,00';
            return num.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        /**
         * Formata uma data para o formato Brasileiro (DD/MM/AAAA).
         * @param {string} dateString - A data no formato YYYY-MM-DD.
         * @returns {string} A data formatada.
         */
        function formatDate(dateString) {
            if (!dateString) return 'Data não informada';
            const date = new Date(dateString + 'T00:00:00'); // Adiciona T00:00:00 para evitar problemas de fuso horário
            return date.toLocaleDateString('pt-BR');
        }

        /**
         * Gera o HTML do CONTRATO de Serviço.
         */
        function generateContractHTML(data) {
            const valorFormatado = formatCurrency(data.valorTotal);
            const dataInicioFormatada = formatDate(data.dataInicio);
            const dataFimFormatada = formatDate(data.dataFim);
            const dataAtual = formatDate(new Date().toISOString().split('T')[0]);

            return `
                <div class="p-4 md:p-8 space-y-6">
                    <div class="text-center border-b pb-4">
                        <h1 class="text-2xl font-bold agp-text-green">CONTRATO DE PRESTAÇÃO DE SERVIÇOS DE PAISAGISMO</h1>
                        <p class="text-sm text-gray-600">Documento gerado em: ${dataAtual}</p>
                    </div>

                    <p class="text-sm text-justify leading-relaxed">
                        Pelo presente instrumento particular, de um lado, a Contratada <strong>${companyInfo.name}</strong>, CNPJ n. ${companyInfo.cnpj}, com sede em ${companyInfo.address}, neste ato representada por ${companyInfo.representative}, e, de outro lado, o Contratante <strong>${data.nomeCliente}</strong>, CPF/CNPJ n. ${data.cpfCliente || 'Não informado'}, residente e domiciliado(a) em ${data.enderecoCliente}, doravante denominado(a) simplesmente Contratante.
                    </p>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA PRIMEIRA - DO OBJETO</h3>
                    <p class="text-sm text-justify leading-relaxed">
                        O presente Contrato tem por objeto a prestação de serviços de **${data.tituloServico}**, conforme a descrição detalhada a seguir:<br>
                        ${data.descricaoServico.split('\n').map(p => `<span>${p}</span><br>`).join('')}
                    </p>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA SEGUNDA - PRAZOS E VALOR</h3>
                    <ul class="list-disc ml-5 text-sm space-y-1">
                        <li><strong>Prazo de Início:</strong> ${dataInicioFormatada}</li>
                        <li><strong>Prazo de Conclusão Estimado:</strong> ${dataFimFormatada}</li>
                        <li><strong>Valor Total:</strong> O Contratante pagará à Contratada o valor total de <strong>${valorFormatado}</strong> (${data.valorTotal} reais) pelos serviços descritos na Cláusula Primeira.</li>
                    </ul>

                    ${data.clausulasAdicionais ? `
                        <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA TERCEIRA - DISPOSIÇÕES ADICIONAIS</h3>
                        <p class="text-sm text-justify whitespace-pre-line">${data.clausulasAdicionais}</p>
                    ` : ''}


                    <p class="text-sm text-center pt-8">
                        E, por estarem justos e contratados, assinam o presente em 02 (duas) vias de igual teor e forma, para que produza seus efeitos legais.
                    </p>

                    <div class="flex justify-around pt-12 text-center">
                        <div>
                            <div class="border-t border-gray-700 w-64 pt-2"></div>
                            <p class="font-semibold text-sm">${companyInfo.name}</p>
                            <p class="text-xs">Contratada</p>
                        </div>
                        <div>
                            <div class="border-t border-gray-700 w-64 pt-2"></div>
                            <p class="font-semibold text-sm">${data.nomeCliente}</p>
                            <p class="text-xs">Contratante</p>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Gera o HTML do RECIBO de Serviço.
         */
        function generateReceiptHTML(data) {
            const valorFormatado = formatCurrency(data.valorTotal);
            const dataInicioFormatada = formatDate(data.dataInicio);
            const dataAtual = formatDate(new Date().toISOString().split('T')[0]);

            if (!data.metodoPagamento) {
                return '<p class="text-center text-red-600">ERRO: O campo "Método de Pagamento" é obrigatório para gerar o Recibo.</p>';
            }

            return `
                <div class="p-4 md:p-8 space-y-6">
                    <div class="text-center border-b pb-4">
                        <h1 class="text-2xl font-bold agp-text-green">RECIBO DE PAGAMENTO DE SERVIÇOS</h1>
                        <p class="text-sm text-gray-600">Referente ao serviço iniciado em: ${dataInicioFormatada}</p>
                    </div>

                    <div class="border-4 agp-border-green p-6 rounded-lg text-center">
                        <p class="text-4xl font-extrabold agp-text-green">${valorFormatado}</p>
                        <p class="text-lg mt-2">Valor Total Recebido</p>
                    </div>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">DETALHES DO PAGAMENTO</h3>
                    <p class="text-base text-justify leading-relaxed">
                        Recebi(emos) de <strong>${data.nomeCliente}</strong>, CPF/CNPJ n. ${data.cpfCliente || 'Não informado'}, a importância de <strong>${valorFormatado}</strong> (${data.valorTotal} reais), referente à prestação de serviços de <strong>${data.tituloServico}</strong>.
                    </p>

                    <ul class="list-disc ml-5 text-sm space-y-1">
                        <li><strong>Serviço:</strong> ${data.tituloServico}</li>
                        <li><strong>Descrição:</strong> Pagamento total (ou parcial) dos serviços de paisagismo e/ou manutenção descritos no contrato/proposta.</li>
                        <li><strong>Método de Pagamento:</strong> ${data.metodoPagamento}</li>
                        <li><strong>Data do Recibo:</strong> ${dataAtual}</li>
                    </ul>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">PRESTADOR DE SERVIÇO</h3>
                    <p class="text-sm leading-relaxed">
                        <strong>${companyInfo.name}</strong><br>
                        CNPJ: ${companyInfo.cnpj}<br>
                        Endereço: ${companyInfo.address}
                    </p>

                    <div class="pt-12 text-center">
                        <div class="border-t border-gray-700 w-64 mx-auto pt-2"></div>
                        <p class="font-semibold text-sm">${companyInfo.representative}</p>
                        <p class="text-xs">Assinatura do Responsável (Almeida Gomes Paisagismo)</p>
                    </div>
                </div>
            `;
        }

        /**
         * Renderiza o preview do documento na área de output.
         */
        function renderPreview() {
            const data = getFormData();
            const form = document.getElementById('docForm');

            // Validação simples do formulário
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            let outputHTML = '';
            if (currentDocType === 'contract') {
                outputHTML = generateContractHTML(data);
            } else if (currentDocType === 'receipt') {
                outputHTML = generateReceiptHTML(data);
            }

            document.getElementById('document-output').innerHTML = outputHTML;
            document.getElementById('form-section').classList.add('hidden');
            document.getElementById('preview-section').classList.remove('hidden');
        }

        /**
         * Oculta o preview e volta ao formulário.
         */
        function hidePreview() {
            document.getElementById('preview-section').classList.add('hidden');
            document.getElementById('form-section').classList.remove('hidden');
        }

        /**
         * Chama a função de impressão do navegador.
         */
        function printDocument() {
            window.print();
        }

        // Inicialização: configura o estado inicial do toggle
        window.onload = initializeToggle;

        // Adiciona classes de estilo dinâmico aos inputs
        document.querySelectorAll('.form-input').forEach(input => {
            input.classList.add('p-3', 'border', 'border-gray-300', 'rounded-lg', 'focus:ring-2', 'focus:ring-green-500', 'focus:border-green-500', 'w-full', 'transition-colors');
        });

    </script>
</body>
</html>