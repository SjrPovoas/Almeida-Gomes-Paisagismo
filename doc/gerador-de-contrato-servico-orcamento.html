<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="title" content="Gerador Online de Contratos, Recibos e Orçamentos da Almeida Gomes Paisagismo">
    <meta name="author" content="SjrPovoaS">
    <meta name="google-site-verification" content="rj9-yKQenuTL7WznZzLhnZhRRqalrW8B9ptmhuewFiA">
    <title>Gerador Online de Contratos, Recibos e Orçamentos da Almeida Gomes Paisagismo</title>
    <link rel="icon" sizes="32x32" href="/img/favicon.ico">
    <link rel="icon" sizes="192x192" href="/img/favicon.ico">
    <link rel="apple-touch-icon" type="image/x-icon" href="/img/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
    <link rel="mask-icon" href="/img/favicon.ico">
    <link rel="canonical" href="https://almeidagomespaisagismo.com.br/doc/gerador-de-contrato-servico-orcamento.html">
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuração do Tailwind para usar o tema de cores AGP -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'agp-green': '#0b4e3e', // Verde Floresta Profundo
                    },
                }
            }
        }
    </script>
    <style>
        /* Configuração de Fonte padrão (Inter é um bom sans-serif profissional) */
        :root {
            font-family: 'Inter', sans-serif;
        }

        /* Cores inspiradas no site da Almeida Gomes Paisagismo (Verde profundo e branco) */
        .agp-text-green {
            color: #0b4e3e;
        }
        .agp-border-green {
            border-color: #0b4e3e;
        }

        /* Estilos para a tabela dinâmica */
        .item-row input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }

        /* Estilos específicos para a visualização de impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 0;
                margin: 0;
                box-shadow: none;
                font-size: 11pt;
            }
            .no-print {
                display: none !important;
            }
            .agp-text-green {
                color: black !important;
            }
            /* Garantir que as linhas alternadas sejam visíveis na impressão (se o cliente tiver cor) */
            .print-area tr:nth-child(even) {
                background-color: #f0f0f0 !important;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">

    <!-- Cabeçalho (Inspirado no branding) -->
    <header class="w-full max-w-4xl p-4 mb-6 bg-white rounded-lg shadow-md flex items-center justify-center space-x-4">
        <!-- Placeholder para o Logo da Almeida Gomes Paisagismo -->
        <img src="/img/logo-clara.webp" 
             alt="Logo Almeida Gomes Paisagismo" 
             class="w-16 h-16 rounded-full object-cover"
             onerror="this.onerror=null; this.src='/img/logo-clara.webp';">
        
        <div class="text-left">
            <h1 class="text-3xl font-bold agp-text-green">Almeida Gomes Paisagismo</h1>
            <p class="text-gray-600 mt-1">Gerador Online de Documentos</p>
        </div>
    </header>

    <main class="w-full max-w-4xl bg-white rounded-lg shadow-xl p-6 md:p-8">

        <!-- Área de Controles e Formulário (Oculta na impressão) -->
        <section id="form-section" class="no-print">
            <div class="mb-6 flex justify-between items-center border-b pb-4">
                <h2 class="text-2xl font-semibold text-gray-800">Detalhes do Documento</h2>
                
                <!-- Toggle Contrato / Recibo / Orçamento -->
                <div class="flex p-1 rounded-full bg-gray-200">
                    <button id="toggleContract" onclick="setDocType('contract')" class="px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200">
                        Contrato
                    </button>
                    <button id="toggleReceipt" onclick="setDocType('receipt')" class="px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200">
                        Recibo
                    </button>
                    <button id="toggleBudget" onclick="setDocType('budget')" class="px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200">
                        Orçamento
                    </button>
                </div>
            </div>

            <!-- Formulário -->
            <form id="docForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Informações do Cliente -->
                <div class="md:col-span-2">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Dados do Cliente</h3>
                </div>
                <input type="text" id="nomeCliente" placeholder="Nome do Cliente/Empresa" class="form-input" required>
                <input type="text" id="cpfCliente" placeholder="CPF/CNPJ do Cliente" class="form-input">
                <input type="text" id="enderecoCliente" placeholder="Endereço Completo do Cliente" class="form-input md:col-span-2" required>

                <!-- Informações do Serviço/Orçamento -->
                <div class="md:col-span-2 mt-4">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Título e Prazos</h3>
                </div>
                <input type="text" id="tituloServico" placeholder="Título Curto do Documento (Ex: Projeto Paisagístico)" class="form-input md:col-span-2" required>
                
                <label class="block text-sm font-medium text-gray-700">Prazo de Início Estimado:</label>
                <input type="date" id="dataInicio" class="form-input" required>
                
                <label class="block text-sm font-medium text-gray-700">Prazo de Conclusão Estimado:</label>
                <input type="date" id="dataFim" class="form-input" required>
                
                <!-- Área de Itens do Orçamento (APENAS para Orçamento) -->
                <div class="md:col-span-2 mt-4" id="budgetItemsSection">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3">Itens do Orçamento (Descrição Detalhada)</h3>
                    
                    <div class="grid grid-cols-12 gap-2 text-sm font-semibold text-gray-600 mb-2">
                        <span class="col-span-4">Descrição de Item</span>
                        <span class="col-span-2">Qtd</span>
                        <span class="col-span-3 text-right">V. Unit (R$)</span>
                        <span class="col-span-2 text-right">V. Total (R$)</span>
                        <span class="col-span-1"></span> <!-- Ação -->
                    </div>

                    <!-- Container para linhas de itens dinâmicas -->
                    <div id="item-list-container" class="space-y-2">
                        <!-- Itens serão inseridos aqui pelo JS -->
                    </div>

                    <button type="button" onclick="addItem()" class="mt-3 px-4 py-2 text-sm rounded-lg border border-agp-green agp-text-green hover:bg-agp-green hover:text-white transition duration-200">
                        + Adicionar Item
                    </button>
                    
                    <div class="flex justify-end mt-4 border-t pt-4">
                        <p class="text-xl font-bold agp-text-green">
                            TOTAL: <span id="displayTotal">R$ 0,00</span>
                            
                        </p>
                    </div>
                    
                </div>
                
                <!-- Campos Antigos (Contrato/Recibo) -->
                <textarea id="descricaoServico" rows="4" placeholder="Descrição Detalhada do Serviço (Contrato/Recibo)." class="form-input md:col-span-2 hidden"></textarea>
                <input type="number" id="valorTotal" step="0.01" placeholder="Valor Total (R$)" class="form-input hidden">
                <select id="metodoPagamento" class="form-input hidden">
                    <option value="" disabled selected>Método de Pagamento (Recibo)</option>
                    <option value="Pix">Pix</option>
                    <option value="Transferência Bancária">Transferência Bancária</option>
                    <option value="Dinheiro">Dinheiro</option>
                    <option value="Cartão de Crédito/Débito">Cartão de Crédito/Débito</option>
                </select>

                <!-- Campo Adicional para Contrato / Orçamento -->
                <div class="md:col-span-2 mt-4" id="contractFields">
                    <h3 class="text-lg font-medium agp-text-green border-b pb-1 mb-3" id="additionalClausesTitle">Termos e Condições</h3>
                    <textarea id="clausulasAdicionais" rows="12" placeholder="Insira quaisquer termos e condições aqui." class="form-input md:col-span-2"></textarea>
                </div>
            </form>

            <!-- Botão de Geração -->
            <button id="generateButton" onclick="renderPreview()" class="w-full mt-8 py-3 rounded-lg text-white font-bold transition duration-300 bg-agp-green hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                Gerar Contrato para Visualização
            </button>
        </section>

        <!-- Área de Visualização e Impressão (Aparece após gerar) -->
        <section id="preview-section" class="hidden mt-8 border-t pt-6">
            <div class="flex justify-between items-center mb-4 no-print">
                <h2 class="text-xl font-semibold text-gray-800">Visualização do Documento</h2>
                <div class="space-x-2">
                    <button onclick="printDocument()" class="px-4 py-2 text-sm font-medium rounded-lg text-white transition duration-200 bg-agp-green hover:bg-green-700">
                        Imprimir / Salvar PDF
                    </button>
                    <button onclick="hidePreview()" class="px-4 py-2 text-sm font-medium rounded-lg bg-gray-300 hover:bg-gray-400">
                        Editar
                    </button>
                </div>
            </div>

            <!-- Container do Documento Gerado -->
            <div id="document-output" class="print-area bg-white p-6 border agp-border-green rounded-lg shadow-inner">
                <!-- O conteúdo HTML será inserido aqui pelo JavaScript -->
            </div>
        </section>

    </main>

    <footer class="mt-6 text-sm text-gray-500">
        Desenvolvido com foco em profissionalismo e facilidade por SjrPovoaS.
    </footer>

    <script>
        // Variáveis Globais de Estado
        let currentDocType = 'contract'; // 'contract', 'receipt', ou 'budget'
        let items = []; // Array para armazenar os itens do orçamento

        // Dados fixos da empresa (Almeida Gomes Paisagismo)
        const companyInfo = {
            name: "ALMEIDA GOMES PAISAGISMO LTDA",
            cnpj: "38.433.248/0001-19 (CNPJ)",
            address: "Quadra 30 Lote 10 Jardim América III Águas Lindas de Goiás - GO. Brasil",
            email: "almeidagomespaisagismo@gmail.com",
            representative: "Representante Legal",
            tel: "(61) 99958-8869",
            instagram: "@almeidagomespaisagismo",
            site: "https://almeidagomespaisagismo.com.br"
        };

        // Elementos do DOM
        const toggleButtons = {
            contract: document.getElementById('toggleContract'),
            receipt: document.getElementById('toggleReceipt'),
            budget: document.getElementById('toggleBudget')
        };
        const paymentSelect = document.getElementById('metodoPagamento');
        const contractFieldsDiv = document.getElementById('contractFields');
        const additionalClausesTitle = document.getElementById('additionalClausesTitle');
        const generateButton = document.getElementById('generateButton');
        const clausulasAdicionais = document.getElementById('clausulasAdicionais');
        const budgetItemsSection = document.getElementById('budgetItemsSection');
        const itemContainer = document.getElementById('item-list-container');
        const displayTotal = document.getElementById('displayTotal');
        const descServicoField = document.getElementById('descricaoServico');
        const valorTotalField = document.getElementById('valorTotal');

        // Conteúdos padrão para o textarea de cláusulas
        const defaultContractClauses = `CLÁUSULA DE MULTAS POR INADIMPLEMENTO:
Em caso de atraso no pagamento superior a [X] dias, será aplicada multa de [Y]% sobre o valor em atraso, além de juros de 1% ao mês.

CLÁUSULA DE GARANTIA:
A Contratada (Almeida Gomes Paisagismo) oferece garantia de [Z] meses sobre a execução do serviço, excluindo-se danos por mau uso, falta de manutenção ou eventos naturais. O Contratante deve seguir o manual de manutenção.

CLÁUSULA DE RESCISÃO:
Qualquer parte poderá rescindir o contrato mediante aviso prévio por escrito de [W] dias. Se a rescisão for sem justa causa pelo Contratante após o início, este deverá pagar os serviços executados mais uma multa compensatória de [K]% do valor restante.`;

        const defaultBudgetTerms = `VALIDADE DA PROPOSTA:
Esta proposta de orçamento é válida por 10 (dez) dias corridos, a contar da data de emissão. Após esse prazo, os valores e prazos podem ser reavaliados.

CONDIÇÕES DE PAGAMENTO:
Pagamento em [X] parcelas, sendo [Y]% no aceite e [Z]% na conclusão.

OBSERVAÇÕES:
Os valores não incluem serviços não especificados na descrição do item.`;


        // Estilo padrão para o botão ativo
        const activeClass = 'bg-agp-green text-white';
        const inactiveClass = 'bg-gray-200 text-gray-700 hover:bg-gray-300';

        /**
         * Inicializa o estado visual do toggle e adiciona um item inicial no orçamento.
         */
        function initializeToggle() {
            setDocType('contract', false);
            addItem(); // Adiciona um item inicial no carregamento
        }
        
        /**
         * Altera o tipo de documento a ser gerado ('contract', 'receipt' ou 'budget').
         * @param {string} type - 'contract', 'receipt' ou 'budget'.
         * @param {boolean} updateButtonText - Se deve atualizar o texto do botão de geração.
         */
        function setDocType(type, updateButtonText = true) {
            currentDocType = type;

            // 1. Atualiza a aparência dos botões de toggle
            Object.keys(toggleButtons).forEach(key => {
                toggleButtons[key].className = `px-4 py-2 text-sm font-medium rounded-full transition-colors duration-200 ${type === key ? activeClass : inactiveClass}`;
            });

            // 2. Controla a visibilidade dos campos específicos
            const isBudget = type === 'budget';
            const isReceipt = type === 'receipt';
            
            // Orçamento vs. Contrato/Recibo
            budgetItemsSection.classList.toggle('hidden', !isBudget);
            descServicoField.classList.toggle('hidden', isBudget);
            valorTotalField.classList.toggle('hidden', isBudget);
            
            // Recibo vs. Contrato/Orçamento
            paymentSelect.classList.toggle('hidden', !isReceipt);
            paymentSelect.disabled = !isReceipt;
            if (isReceipt) {
                 paymentSelect.setAttribute('required', 'required');
                 valorTotalField.classList.remove('hidden'); // Recibo precisa do valor total manual
                 descServicoField.classList.remove('hidden'); // Recibo precisa da descrição/título do serviço
            } else {
                 paymentSelect.removeAttribute('required');
                 paymentSelect.value = "";
            }
            
            // Contrato/Orçamento vs. Recibo
            contractFieldsDiv.classList.toggle('hidden', isReceipt);

            // 3. Ajusta o título das cláusulas e o conteúdo padrão
            if (isBudget) {
                additionalClausesTitle.textContent = 'Termos e Condições (Validade de 10 Dias)';
                clausulasAdicionais.value = defaultBudgetTerms;
            } else if (type === 'contract') {
                additionalClausesTitle.textContent = 'Cláusulas Adicionais (Contrato)';
                clausulasAdicionais.value = defaultContractClauses;
            }

            // 4. Atualiza o texto do botão de geração
            if (updateButtonText) {
                const docName = type === 'contract' ? 'Contrato' : (isReceipt ? 'Recibo' : 'Orçamento');
                generateButton.textContent = `Gerar ${docName} para Visualização`;
            }
            
            updateTotal(); // Garante que o total seja atualizado ao mudar o tipo (se for orçamento)
        }
        
        // --- Funções de Manipulação da Tabela de Itens (Orçamento) ---
        
        /**
         * Adiciona uma nova linha de item ao formulário.
         */
        function addItem() {
            const newItemId = items.length;
            items.push({
                id: newItemId,
                description: '',
                quantity: 1,
                unitValue: 0,
                total: 0
            });
            renderItems();
        }

        /**
         * Remove uma linha de item do formulário.
         */
        function removeItem(id) {
            items = items.filter(item => item.id !== id);
            // Re-renderiza para atualizar os IDs visuais
            renderItems(); 
            updateTotal();
        }
        
        /**
         * Renderiza todas as linhas de itens na interface.
         */
        function renderItems() {
            itemContainer.innerHTML = items.map((item, index) => {
                const totalValue = item.quantity * item.unitValue;
                
                return `
                    <div class="item-row grid grid-cols-12 gap-2">
                        <input type="text" id="desc-${item.id}" value="${item.description}" placeholder="Item ${index + 1}: Planta, Mão de Obra, etc." oninput="updateItem(${item.id}, 'description', this.value)" class="col-span-4" required>
                        <input type="number" id="qty-${item.id}" value="${item.quantity}" min="0.01" step="0.01" oninput="updateItem(${item.id}, 'quantity', parseFloat(this.value) || 0)" class="col-span-2 text-center" required>
                        <input type="number" id="unit-${item.id}" value="${item.unitValue.toFixed(2)}" min="0.00" step="0.01" oninput="updateItem(${item.id}, 'unitValue', parseFloat(this.value) || 0)" class="col-span-3 text-right" required>
                        <span id="total-${item.id}" class="col-span-2 text-right p-2 font-medium">${formatCurrency(totalValue)}</span>
                        <button type="button" onclick="removeItem(${item.id})" class="col-span-1 text-red-600 hover:text-red-800 text-lg transition duration-200">
                            &times;
                        </button>
                    </div>
                `;
            }).join('');
            updateTotal();
        }
        
        /**
         * Atualiza um valor de item no array e recalcula o total.
         */
        function updateItem(id, key, value) {
            const itemIndex = items.findIndex(item => item.id === id);
            if (itemIndex > -1) {
                items[itemIndex][key] = value;
                
                const item = items[itemIndex];
                const newTotal = item.quantity * item.unitValue;
                items[itemIndex].total = newTotal;
                
                // Atualiza o display do V. Total do item
                document.getElementById(`total-${id}`).textContent = formatCurrency(newTotal);
                
                updateTotal();
            }
        }

        /**
         * Recalcula e exibe o valor total de todos os itens.
         */
        function updateTotal() {
            const grandTotal = items.reduce((sum, item) => sum + (item.quantity * item.unitValue), 0);
            displayTotal.textContent = formatCurrency(grandTotal);
            
            // Oculta o campo valorTotal e define seu valor (para a lógica de Contrato/Recibo, caso necessário)
            valorTotalField.value = grandTotal.toFixed(2);
        }

        // --- Funções de Auxílio e Geração ---

        /**
         * Coleta os dados do formulário em um objeto.
         */
        function getFormData() {
            const data = {};
            const formElements = document.getElementById('docForm').elements;
            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];
                if (element.id && !element.classList.contains('hidden')) {
                    data[element.id] = element.value;
                }
            }
            
            // Adiciona a lista de itens e o total calculado para Orçamento
            if (currentDocType === 'budget') {
                data.items = items.map(item => ({
                    description: document.getElementById(`desc-${item.id}`).value,
                    quantity: parseFloat(document.getElementById(`qty-${item.id}`).value) || 0,
                    unitValue: parseFloat(document.getElementById(`unit-${item.id}`).value) || 0,
                    total: (parseFloat(document.getElementById(`qty-${item.id}`).value) || 0) * (parseFloat(document.getElementById(`unit-${item.id}`).value) || 0)
                }));
                data.valorTotal = data.items.reduce((sum, item) => sum + item.total, 0).toFixed(2);
            }

            return data;
        }

        /**
         * Formata um valor numérico para o formato monetário Brasileiro (R$ X.XXX,XX).
         */
        function formatCurrency(value) {
            const num = parseFloat(value);
            if (isNaN(num)) return 'R$ 0,00';
            return num.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        /**
         * Formata uma data para o formato Brasileiro (DD/MM/AAAA).
         */
        function formatDate(dateString) {
            if (!dateString) return 'Data não informada';
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('pt-BR');
        }

        /**
         * Gera o HTML do CONTRATO de Serviço.
         */
        function generateContractHTML(data) {
            const valorFormatado = formatCurrency(data.valorTotal);
            const dataInicioFormatada = formatDate(data.dataInicio);
            const dataFimFormatada = formatDate(data.dataFim);
            const dataAtual = formatDate(new Date().toISOString().split('T')[0]);

            return `
                <div class="p-4 md:p-8 space-y-6">
                    <div class="text-center border-b pb-4">
                        <img src="/img/logo-clara.webp" alt="Logo Almeida Gomes Paisagismo" class="w-16 h-16 rounded-full object-cover mx-auto mb-2" onerror="this.onerror=null; this.src='https://placehold.co/60x60/0b4e3e/ffffff?text=AGP';">
                        <h1 class="text-2xl font-bold agp-text-green">CONTRATO DE PRESTAÇÃO DE SERVIÇOS</h1>
                        <p class="text-sm text-gray-600">Documento gerado em: ${dataAtual}</p>
                    </div>

                    <!-- ... (Restante do Contrato HTML, usando data.descricaoServico e data.valorTotal) ... -->
                    <p class="text-sm text-justify leading-relaxed">
                        Pelo presente instrumento particular, de um lado, a Contratada <strong>${companyInfo.name}</strong>, CNPJ n. ${companyInfo.cnpj}, com sede em ${companyInfo.address}, neste ato representada por ${companyInfo.representative}, e, de outro lado, o Contratante <strong>${data.nomeCliente}</strong>, CPF/CNPJ n. ${data.cpfCliente || 'Não informado'}, residente e domiciliado(a) em ${data.enderecoCliente}, doravante denominado(a) simplesmente Contratante.
                    </p>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA PRIMEIRA - DO OBJETO</h3>
                    <p class="text-sm text-justify leading-relaxed">
                        O presente Contrato tem por objeto a prestação de serviços de **${data.tituloServico}**, conforme a descrição detalhada a seguir:<br>
                        ${data.descricaoServico.split('\n').map(p => `<span>${p}</span><br>`).join('')}
                    </p>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA SEGUNDA - PRAZOS E VALOR</h3>
                    <ul class="list-disc ml-5 text-sm space-y-1">
                        <li><strong>Prazo de Início:</strong> ${dataInicioFormatada}</li>
                        <li><strong>Prazo de Conclusão Estimado:</strong> ${dataFimFormatada}</li>
                        <li><strong>Valor Total:</strong> O Contratante pagará à Contratada o valor total de <strong>${valorFormatado}</strong> (${data.valorTotal} reais) pelos serviços descritos na Cláusula Primeira.</li>
                    </ul>

                    ${data.clausulasAdicionais ? `
                        <h3 class="font-bold agp-text-green text-lg border-b mt-4">CLÁUSULA TERCEIRA - DISPOSIÇÕES ADICIONAIS</h3>
                        <p class="text-sm text-justify whitespace-pre-line">${data.clausulasAdicionais}</p>
                    ` : ''}


                    <p class="text-sm text-center pt-8">
                        E, por estarem justos e contratados, assinam o presente em 02 (duas) vias de igual teor e forma, para que produza seus efeitos legais.
                    </p>

                    <div class="flex justify-around pt-12 text-center">
                        <div>
                            <div class="border-t border-gray-700 w-64 pt-2"></div>
                            <p class="font-semibold text-sm">${companyInfo.name}</p>
                            <p class="text-xs">Contratada</p>
                        </div>
                        <div>
                            <div class="border-t border-gray-700 w-64 pt-2"></div>
                            <p class="font-semibold text-sm">${data.nomeCliente}</p>
                            <p class="text-xs">Contratante</p>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Gera o HTML do ORÇAMENTO de Serviço.
         */
        function generateBudgetHTML(data) {
            const valorFormatado = formatCurrency(data.valorTotal);
            const dataInicioFormatada = formatDate(data.dataInicio);
            const dataFimFormatada = formatDate(data.dataFim);
            const dataAtual = new Date();
            const dataAtualFormatada = formatDate(dataAtual.toISOString().split('T')[0]);
            
            // Validade: Adiciona 10 dias corridos
            const validadeDate = new Date(dataAtual);
            validadeDate.setDate(dataAtual.getDate() + 10);
            const validadeFormatada = validadeDate.toLocaleDateString('pt-BR');

            // Geração da Tabela de Itens
            const itemRows = data.items.filter(item => item.total > 0 || item.description).map((item, index) => {
                const totalFormatado = formatCurrency(item.total);
                const unitFormatado = formatCurrency(item.unitValue).replace('R$', '').trim();
                const rowClass = index % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                
                return `
                    <tr class="${rowClass} border-b text-sm">
                        <td class="w-10 text-center py-2">${index + 1}</td>
                        <td class="w-1/2 p-2">${item.description || '-'}</td>
                        <td class="w-10 text-center p-2">${item.quantity.toLocaleString('pt-BR')}</td>
                        <td class="w-1/6 text-right p-2">${unitFormatado}</td>
                        <td class="w-1/6 text-right p-2 font-semibold">${totalFormatado}</td>
                    </tr>
                `;
            }).join('');

            return `
                <div class="p-4 md:p-8 space-y-6">
                    <div class="text-center pb-4 border-b-4 agp-border-green">
                        <img src="/img/logo-clara.webp" alt="Logo Almeida Gomes Paisagismo" class="w-16 h-16 rounded-full object-cover mx-auto mb-2" onerror="this.onerror=null; this.src='https://placehold.co/60x60/0b4e3e/ffffff?text=AGP';">
                        <h1 class="text-2xl font-bold agp-text-green">PROPOSTA DE ORÇAMENTO Nº ${Math.floor(Math.random() * 9000) + 1000}</h1>
                        <p class="text-sm text-gray-600">Data de Emissão: ${dataAtualFormatada}</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4 text-sm border-b pb-4">
                        <div class="space-y-1">
                            <h3 class="font-bold agp-text-green">PRESTADOR DE SERVIÇO</h3>
                            <p>${companyInfo.name}</p>
                            <p>CNPJ: ${companyInfo.cnpj}</p>
                            <p>Whatsapp: ${companyInfo.tel}</p>
                            <p>Instagram: ${companyInfo.instagram}</p>
                            <p>Site: ${companyInfo.site}</p>
                        </div>
                        <div class="space-y-1">
                            <h3 class="font-bold agp-text-green">CLIENTE</h3>
                            <p>${data.nomeCliente}</p>
                            <p>CPF/CNPJ: ${data.cpfCliente || 'Não informado'}</p>
                            <p>Endereço: ${data.enderecoCliente}</p>
                        </div>
                    </div>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">TÍTULO DO ORÇAMENTO: ${data.tituloServico}</h3>
                    
                    <!-- Tabela de Detalhamento -->
                    <div class="overflow-x-auto border agp-border-green rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-agp-green text-white text-xs uppercase tracking-wider">
                                <tr>
                                    <th class="w-10 text-center p-2">ÍTEM</th>
                                    <th class="w-1/2 text-left p-2">DESCRIÇÃO DE ÍTEM</th>
                                    <th class="w-10 text-center p-2">QTD</th>
                                    <th class="w-1/6 text-right p-2">V. UNIT (R$)</th>
                                    <th class="w-1/6 text-right p-2">V. TOTAL (R$)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${itemRows}
                            </tbody>
                        </table>
                    </div>

                    <!-- Resumo e Validade -->
                    <div class="flex justify-between items-center mt-4 p-4 border-4 agp-border-green rounded-lg bg-gray-50">
                        <div>
                            <p class="text-sm font-semibold">Prazo de Validade:</p>
                            <p class="text-base font-bold text-red-600">${validadeFormatada} (10 dias corridos)</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold">VALOR TOTAL:</p>
                            <p class="text-4xl font-extrabold agp-text-green">${valorFormatado}</p>
                            <p class="text-sm mt-1">Prazo Execução Estimado: ${dataInicioFormatada} a ${dataFimFormatada}</p>
                        </div>
                    </div>
                    
                    ${data.clausulasAdicionais ? `
                        <h3 class="font-bold agp-text-green text-lg border-b mt-4">TERMOS E CONDIÇÕES</h3>
                        <p class="text-sm text-justify whitespace-pre-line leading-relaxed">${data.clausulasAdicionais}</p>
                    ` : ''}

                </div>
            `;
        }


        /**
         * Gera o HTML do RECIBO de Serviço.
         */
        function generateReceiptHTML(data) {
            const valorFormatado = formatCurrency(data.valorTotal);
            const dataInicioFormatada = formatDate(data.dataInicio);
            const dataAtual = formatDate(new Date().toISOString().split('T')[0]);

            if (!data.metodoPagamento) {
                return '<p class="text-center text-red-600">ERRO: O campo "Método de Pagamento" é obrigatório para gerar o Recibo.</p>';
            }
            
            // ... (Restante do Recibo HTML, usando data.descricaoServico e data.valorTotal) ...
            return `
                <div class="p-4 md:p-8 space-y-6">
                    <div class="text-center border-b pb-4">
                        <img src="/img/logo-clara.webp" alt="Logo Almeida Gomes Paisagismo" class="w-16 h-16 rounded-full object-cover mx-auto mb-2" onerror="this.onerror=null; this.src='https://placehold.co/60x60/0b4e3e/ffffff?text=AGP';">
                        <h1 class="text-2xl font-bold agp-text-green">RECIBO DE PAGAMENTO DE SERVIÇOS</h1>
                        <p class="text-sm text-gray-600">Referente ao serviço iniciado em: ${dataInicioFormatada}</p>
                    </div>

                    <div class="border-4 agp-border-green p-6 rounded-lg text-center">
                        <p class="text-4xl font-extrabold agp-text-green">${valorFormatado}</p>
                        <p class="text-lg mt-2">Valor Total Recebido</p>
                    </div>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">DETALHES DO PAGAMENTO</h3>
                    <p class="text-base text-justify leading-relaxed">
                        Recebi(emos) de <strong>${data.nomeCliente}</strong>, CPF/CNPJ n. ${data.cpfCliente || 'Não informado'}, a importância de <strong>${valorFormatado}</strong> (${data.valorTotal} reais), referente à prestação de serviços de <strong>${data.tituloServico}</strong>.
                    </p>

                    <ul class="list-disc ml-5 text-sm space-y-1">
                        <li><strong>Serviço:</strong> ${data.tituloServico}</li>
                        <li><strong>Método de Pagamento:</strong> ${data.metodoPagamento}</li>
                        <li><strong>Data do Recibo:</strong> ${dataAtual}</li>
                    </ul>

                    <h3 class="font-bold agp-text-green text-lg border-b mt-4">PRESTADOR DE SERVIÇO</h3>
                    <p class="text-sm leading-relaxed">
                        <strong>${companyInfo.name}</strong><br>
                        CNPJ: ${companyInfo.cnpj}<br>
                        Endereço: ${companyInfo.address}<br>
                        Whatsapp: ${companyInfo.tel}<br>
                        Instagram: ${companyInfo.instagram}<br>
                        Site: ${companyInfo.site}
                    </p>

                    <div class="pt-12 text-center">
                        <div class="border-t border-gray-700 w-64 mx-auto pt-2"></div>
                        <p class="font-semibold text-sm">${companyInfo.representative}</p>
                        <p class="text-xs">Assinatura do Responsável (Almeida Gomes Paisagismo)</p>
                    </div>
                </div>
            `;
        }


        /**
         * Renderiza o preview do documento na área de output.
         */
        function renderPreview() {
            const data = getFormData();
            const form = document.getElementById('docForm');

            // Validação simples do formulário
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // Validação específica para orçamento
            if (currentDocType === 'budget' && items.length === 0) {
                 // Cria um alerta de modal personalizado (não usando alert())
                 alert('Por favor, adicione pelo menos um item ao orçamento.');
                 return;
            }
            if (currentDocType === 'budget' && data.items.every(item => item.total === 0)) {
                 alert('O valor total do orçamento não pode ser zero. Verifique as quantidades e valores unitários.');
                 return;
            }


            let outputHTML = '';
            if (currentDocType === 'contract') {
                outputHTML = generateContractHTML(data);
            } else if (currentDocType === 'receipt') {
                outputHTML = generateReceiptHTML(data);
            } else if (currentDocType === 'budget') {
                outputHTML = generateBudgetHTML(data);
            }

            document.getElementById('document-output').innerHTML = outputHTML;
            document.getElementById('form-section').classList.add('hidden');
            document.getElementById('preview-section').classList.remove('hidden');
        }

        /**
         * Oculta o preview e volta ao formulário.
         */
        function hidePreview() {
            document.getElementById('preview-section').classList.add('hidden');
            document.getElementById('form-section').classList.remove('hidden');
        }

        /**
         * Chama a função de impressão do navegador.
         */
        function printDocument() {
            window.print();
        }

        // Inicialização: configura o estado inicial do toggle e itens
        window.onload = initializeToggle;

        // Adiciona classes de estilo dinâmico aos inputs
        document.querySelectorAll('.form-input').forEach(input => {
            input.classList.add('p-3', 'border', 'border-gray-300', 'rounded-lg', 'focus:ring-2', 'focus:ring-green-500', 'focus:border-green-500', 'w-full', 'transition-colors');
        });

    </script>
</body>
</html>